
{% extends "base.html" %}
{% block content %}
<h2 class="text-xl font-semibold mb-3">Maintenance Requests</h2>
<form action="/maintenance" method="post" enctype="multipart/form-data" class="space-y-3">
  <textarea name="note" required rows="3" placeholder="Describe the issue..." class="border rounded w-full p-2"></textarea>
  <input type="file" name="photo" accept="image/*" class="block">
  <button class="bg-green-600 text-white px-4 py-2 rounded">Submit</button>
  {% if request.query_params.get('receipt') %}
    <a class="ml-3 text-blue-700 underline" href="/receipt/maintenance/{{request.query_params.get('receipt')}}.pdf">Download receipt (PDF)</a>
  {% endif %}
</form>
<h3 class="text-lg font-semibold mt-6 mb-2">My Requests</h3>
<table class="w-full text-sm border">
  <thead class="bg-gray-100"><tr>
    <th class="p-2 border">ID</th><th class="p-2 border">Note</th><th class="p-2 border">Status</th><th class="p-2 border">Photo</th><th class="p-2 border">Created</th>
  </tr></thead>
  <tbody>
  {% for r in rows %}
  <tr>
    <td class="p-2 border">{{r.id}}</td>
    <td class="p-2 border">{{r.note}}</td>
    <td class="p-2 border">{{r.status}}</td>
    <td class="p-2 border">{% if r.photo %}<a class="text-blue-600 underline" href="/{{r.photo}}">view</a>{% else %}-{% endif %}</td>
    <td class="p-2 border">{{r.created_at}}</td>
  </tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
