
{% extends "base.html" %}
{% block content %}
<h2 class="text-xl font-semibold mb-3">Payments</h2>
<form action="/payments" method="post" class="grid md:grid-cols-4 gap-2 max-w-3xl">
  <input name="description" required placeholder="Description" class="border rounded px-3 py-2">
  <input name="amount" type="number" step="0.01" required placeholder="Amount" class="border rounded px-3 py-2">
  <input name="due_date" type="date" required class="border rounded px-3 py-2">
  <button class="bg-blue-600 text-white rounded px-3 py-2">Add Invoice</button>
  {% if request.query_params.get('receipt') %}
    <a class="text-blue-700 underline" href="/receipt/payment/{{request.query_params.get('receipt')}}.pdf">Download receipt (PDF)</a>
  {% endif %}
</form>
<table class="w-full text-sm border mt-4">
  <thead class="bg-gray-100">
    <tr>
      <th class="p-2 border">ID</th><th class="p-2 border">Description</th><th class="p-2 border">Amount</th>
      <th class="p-2 border">Due</th><th class="p-2 border">Status</th><th class="p-2 border">Action</th>
    </tr>
  </thead>
  <tbody>
  {% for r in rows %}
  <tr>
    <td class="p-2 border">{{r.id}}</td>
    <td class="p-2 border">{{r.description}}</td>
    <td class="p-2 border">â‚±{{"%.2f"|format(r.amount)}}</td>
    <td class="p-2 border">{{r.due_date}}</td>
    <td class="p-2 border">{{r.status}}</td>
    <td class="p-2 border">
      {% if r.status != "Paid" %}
      <form action="/payments/{{r.id}}/mark-paid" method="post"><button class="bg-green-600 text-white px-3 py-1 rounded">Mark Paid</button></form>
      {% endif %}
      <a class="text-blue-700 underline ml-2" href="/receipt/payment/{{r.id}}.pdf">Receipt</a>
    </td>
  </tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
